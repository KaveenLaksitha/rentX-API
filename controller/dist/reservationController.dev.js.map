{"version":3,"sources":["reservationController.js"],"names":["controller","require","Router","Reservation","uuidv4","v4","isMoment","route","post","req","res","reservationid","customername","body","contactnumber","Number","nic","customernic","customeraddress","packagename","eventtype","from","format","to","discount","advancedpayment","totalreservation","status","newReservation","save","then","send","message","err","error","get","find","reservation","json","console","log","RID","params","findOne","findOneAndDelete","put","updateReservation","findOneAndUpdate","updateReserve","module","exports"],"mappings":"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","sourcesContent":["const controller = require(\"express\").Router();\r\nlet Reservation = require(\"../model/reservationModel\");\r\nconst {v4:uuidv4} = require(\"uuid\");\r\nconst { Router } = require(\"express\");\r\nconst isMoment  = require(\"moment\");\r\n\r\n\r\n//insert data\r\ncontroller.route(\"/addReservation\").post((req,res)=>{\r\n    \r\n    const reservationid = uuidv4();\r\n    const customername = req.body.customername;\r\n    const contactnumber = Number(req.body.contactnumber);\r\n    const nic = req.body.nic;\r\n    const customernic = req.body.customernic;\r\n    const customeraddress = req.body.customeraddress;\r\n    const packagename = req.body.packagename;\r\n    const eventtype = req.body.eventtype;\r\n    const from = isMoment(req.body.from).format('MM-DD-YYYY');\r\n    const to = isMoment(req.body.to).format('MM-DD-YYYY');\r\n    const discount = Number(req.body.discount);\r\n    const advancedpayment = Number(req.body.advancedpayment);\r\n    const totalreservation = Number(req.body.totalreservation);\r\n    const status = req.body.status;\r\n\r\n    const newReservation = new Reservation({\r\n        reservationid,\r\n        customername,\r\n        contactnumber,\r\n        nic,\r\n        customernic,\r\n        customeraddress,\r\n        packagename,\r\n        eventtype,\r\n        from,\r\n        to,\r\n        discount,\r\n        advancedpayment,\r\n        totalreservation,\r\n        status\r\n    })\r\n\r\n    newReservation.save().then(()=>{\r\n        res.status(200).send({message:\"Reservation insert successfully\"})\r\n    }).catch((err)=>{\r\n        res.status(300).send({status:\"Error Reservation insertion\",error: err.message});\r\n    })\r\n})\r\n\r\n//retrieve all order details\r\ncontroller.route(\"/displayReservation\").get((req,res) =>{\r\n    Reservation.find().then((reservation) => {\r\n        res.json(reservation)\r\n    }).catch((err)=>{\r\n        console.log(err);\r\n    })\r\n})\r\n\r\n\r\n//To retrieve the reservation details of a specific order \r\ncontroller.route(\"/getReservation/:RID\").get(async(req,res) => {\r\n\r\n    let RID = req.params.RID;\r\n\r\n    const reservation = await Reservation.findOne({reservationid : RID})\r\n    .then((reservation) =>{\r\n        if(reservation != null){\r\n            res.status(200).send({status :\"Reservation fetched\", reservation:reservation})\r\n            //res.status(500).send({status : \"Error with get Reservation\", error:err.message});\r\n        }else{\r\n            res.status(500).send({status : \"Error with get Reservation\", error:err.message});\r\n            //res.status(200).send({status :\"Reservation fetched\", reservation:reservation})\r\n        }       \r\n    }).catch((err) => {\r\n        console.log(err.message);\r\n        res.status(500).send({status : \"Error with get Reservation\", error:err.message});\r\n    })\r\n\r\n})\r\n\r\n//to delete a specific reservation from database\r\ncontroller.route(\"/deleteReservation/:RID\").delete(async(req,res)=>{\r\n    let RID = req.params.RID; //Reservation ID taken from frontend\r\n\r\n    const reservation = await Reservation.findOneAndDelete({reservationid : RID})\r\n    .then((reservation)=> {\r\n        if(reservation != null){\r\n            res.status(200).send({status :\"Reservation deleted\"})\r\n        }else{\r\n            res.status(500).send({status : \"Error with delete Reservation\", error:err.message});\r\n        }   \r\n    }).catch((err)=>{\r\n        console.log(err);\r\n        res.status(500).send({status : \"Error with delete Reservation\", error:err.message});\r\n    })\r\n})\r\n\r\n//to update the reservation details\r\ncontroller.route(\"/updateReservation/:RID\").put(async(req,res) => {\r\n    let RID = req.params.RID;\r\n\r\n    //we have to fetch the new updating details coming from the front end here-new feature called d structure\r\n\r\n    const {\r\n        //reservationid,\r\n        customername,\r\n        contactnumber,\r\n        nic,\r\n        customernic,\r\n        customeraddress,\r\n        packagename,\r\n        eventtype,\r\n        from,\r\n        to,\r\n        discount,\r\n        advancedpayment,\r\n        totalreservation,\r\n        status\r\n    } = req.body;//we call this as dStructure\r\n\r\n    const updateReservation ={\r\n        //reservationid,\r\n        customername,\r\n        contactnumber,\r\n        nic,\r\n        customernic,\r\n        customeraddress,\r\n        packagename,\r\n        eventtype,\r\n        from,\r\n        to,\r\n        discount,\r\n        advancedpayment,\r\n        totalreservation,\r\n        status\r\n    }//create a object containing the data that needs to be updated\r\n\r\n       //we have to pass the primary key and then value to be passed\r\n    const updateReserve = await Reservation.findOneAndUpdate({reservationid:RID},updateReservation)\r\n    .then((updateReserve)=> {\r\n        if(updateReserve != null){\r\n            res.status(200).send({status :\"Reservation updated\"})//sending details of the updated data back to front end\r\n        }else{\r\n            res.status(500).send({status : \"Error with updating Reservation\", error:err.message});\r\n        }   \r\n    }).catch((err)=>{\r\n        console.log(err);\r\n        res.status(500).send({status : \"Error with delete Reservation\", error:err.message});\r\n    })\r\n})\r\n\r\n\r\n\r\nmodule.exports = controller;"],"file":"reservationController.dev.js"}