"use strict";var controller=require("express").Router(),Reservation=require("../model/reservationModel"),_require=require("uuid"),uuidv4=_require.v4,_require2=require("express"),Router=_require2.Router,isMoment=require("moment"),Vehicles=require("../model/vehicleModel");controller.route("/addReservation").post(function(e,t){var r=uuidv4(),n=e.body.customername,s=Number(e.body.contactnumber),o=e.body.nic,a=e.body.customernic,u=e.body.customeraddress,i=e.body.packagename,c=e.body.eventtype,d=isMoment(e.body.from).format("MM-DD-YYYY"),m=isMoment(e.body.to).format("MM-DD-YYYY"),l=Number(e.body.discount),v=Number(e.body.advancedpayment),p=Number(e.body.totalreservation),f=e.body.status;new Reservation({reservationid:r,customername:n,contactnumber:s,nic:o,customernic:a,customeraddress:u,packagename:i,eventtype:c,from:d,to:m,discount:l,advancedpayment:v,totalreservation:p,status:f}).save().then(function(){t.status(200).send({message:"Reservation insert successfully"})}).catch(function(e){t.status(300).send({status:"Error Reservation insertion",error:e.message})})}),controller.route("/displayReservation").get(function(e,t){Reservation.find().then(function(e){t.json(e)}).catch(function(e){console.log(e)})}),controller.route("/getReservation/:RID").get(function(t,r){var n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.RID,e.next=3,regeneratorRuntime.awrap(Reservation.findOne({reservationid:n}).then(function(e){null!=e?r.status(200).send({status:"Reservation fetched",reservation:e}):r.status(500).send({status:"Error with get Reservation",error:err.message})}).catch(function(e){console.log(e.message),r.status(500).send({status:"Error with get Reservation",error:e.message})}));case 3:e.sent;case 4:case"end":return e.stop()}})}),controller.route("/deleteReservation/:RID").delete(function(t,r){var n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.RID,e.next=3,regeneratorRuntime.awrap(Reservation.findOneAndDelete({reservationid:n}).then(function(e){null!=e?r.status(200).send({status:"Reservation deleted"}):r.status(500).send({status:"Error with delete Reservation",error:err.message})}).catch(function(e){console.log(e),r.status(500).send({status:"Error with delete Reservation",error:e.message})}));case 3:e.sent;case 4:case"end":return e.stop()}})}),controller.route("/updateReservation/:RID").put(function(t,r){var n,s,o,a,u,i,c,d,m,l,v,p,f,R,g,y;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.params.RID,s=t.body,o=s.customername,a=s.contactnumber,u=s.nic,i=s.customernic,c=s.customeraddress,d=s.packagename,m=s.eventtype,l=s.from,v=s.to,p=s.discount,f=s.advancedpayment,R=s.totalreservation,g=s.status,y={customername:o,contactnumber:a,nic:u,customernic:i,customeraddress:c,packagename:d,eventtype:m,from:l,to:v,discount:p,advancedpayment:f,totalreservation:R,status:g},e.next=5,regeneratorRuntime.awrap(Reservation.findOneAndUpdate({reservationid:n},y).then(function(e){null!=e?r.status(200).send({status:"Reservation updated"}):r.status(500).send({status:"Error with updating Reservation",error:err.message})}).catch(function(e){console.log(e),r.status(500).send({status:"Error with delete Reservation",error:e.message})}));case 5:e.sent;case 6:case"end":return e.stop()}})}),controller.route("/searchVehicleModel/:vType").get(function(e,t){var r=e.params.vType.trim();Vehicles.find({VehicleID:{$regex:".*"+r+".*",$options:"i"}}).then(function(e){t.json(e)}).catch(function(e){console.log(e)})}),module.exports=controller;
//# sourceMappingURL=reservationController.min.js.map
